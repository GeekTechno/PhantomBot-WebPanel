(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery.ui-contextmenu"],e)}else{e(jQuery)}})(function(e){"use strict";var t="onselectstart"in document.createElement("div"),n,i;e.widget("moogle.contextmenu",{version:"@VERSION",options:{autoTrigger:true,delegate:null,hide:{effect:"fadeOut",duration:"fast"},ignoreParentSelect:true,menu:null,position:null,preventContextMenuForPopup:false,preventSelect:false,show:{effect:"slideDown",duration:"fast"},taphold:false,uiMenuOptions:{},beforeOpen:e.noop,blur:e.noop,close:e.noop,create:e.noop,createMenu:e.noop,focus:e.noop,open:e.noop,select:e.noop},_create:function(){var n,i,s,o=this.options;this.$headStyle=null;this.$menu=null;this.menuIsTemp=false;this.currentTarget=null;if(o.preventSelect){s=(e(this.element).is(document)?e("body"):this.element).uniqueId().attr("id");n="#"+s+" "+o.delegate+" { "+"-webkit-user-select: none; "+"-khtml-user-select: none; "+"-moz-user-select: none; "+"-ms-user-select: none; "+"user-select: none; "+"}";this.$headStyle=e("<style class='moogle-contextmenu-style' />").prop("type","text/css").appendTo("head");try{this.$headStyle.html(n)}catch(a){this.$headStyle[0].styleSheet.cssText=n}if(t){this.element.delegate(o.delegate,"selectstart"+this.eventNamespace,function(e){e.preventDefault()})}}this._createUiMenu(o.menu);i="contextmenu"+this.eventNamespace;if(o.taphold){i+=" taphold"+this.eventNamespace}this.element.delegate(o.delegate,i,e.proxy(this._openMenu,this))},_destroy:function(){this.element.undelegate(this.eventNamespace);this._createUiMenu(null);if(this.$headStyle){this.$headStyle.remove();this.$headStyle=null}},_createUiMenu:function(t){var n;if(this.isOpen()){n=this.currentTarget;this._closeMenu(true);this.currentTarget=n}if(this.menuIsTemp){this.$menu.remove()}else if(this.$menu){this.$menu.menu("destroy").hide()}this.$menu=null;this.menuIsTemp=false;if(!t){return}else if(e.isArray(t)){this.$menu=e.moogle.contextmenu.createMenuMarkup(t);this.menuIsTemp=true}else if(typeof t==="string"){this.$menu=e(t)}else{this.$menu=t}this.$menu.hide().menu(e.extend(true,{},this.options.uiMenuOptions,{blur:e.proxy(this.options.blur,this),create:e.proxy(this.options.createMenu,this),focus:e.proxy(this.options.focus,this),select:e.proxy(function(t,n){var i,s=e.moogle.contextmenu.isMenu(n.item),o=n.item.data("actionHandler");n.cmd=n.item.attr("data-command");n.target=e(this.currentTarget);if(!s||!this.options.ignoreParentSelect){i=this._trigger.call(this,"select",t,n);if(o){i=o.call(this,t,n)}if(i!==false){this._closeMenu.call(this)}t.preventDefault()}},this)}))},_openMenu:function(t){var n=this.options,i=n.position,s=this,o=!!t.isTrigger,a={menu:this.$menu,target:e(t.target),extraData:t.extraData,originalEvent:t};if(!n.autoTrigger&&!o){return}this.currentTarget=t.target;t.preventDefault();if(this._trigger("beforeOpen",t,a)===false){this.currentTarget=null;return false}a.menu=this.$menu;e(document).bind("keydown"+this.eventNamespace,function(t){if(t.which===e.ui.keyCode.ESCAPE){s._closeMenu()}}).bind("mousedown"+this.eventNamespace+" touchstart"+this.eventNamespace,function(t){if(!e(t.target).closest(".ui-menu-item").length){s._closeMenu()}});if(e.isFunction(i)){i=i(t,a)}i=e.extend({my:"left top",at:"left bottom",of:t.pageX===undefined?t.target:t,collision:"fit"},i);this.$menu.show().css({position:"absolute",left:0,top:0}).position(i).hide();if(n.preventContextMenuForPopup){this.$menu.bind("contextmenu"+this.eventNamespace,function(e){e.preventDefault()})}this._show(this.$menu,this.options.show,function(){s._trigger.call(s,"open",t,a)})},_closeMenu:function(t){var n=this,i=t?false:this.options.hide;e(document).unbind("mousedown"+this.eventNamespace).unbind("touchstart"+this.eventNamespace).unbind("keydown"+this.eventNamespace);this.$menu.unbind("contextmenu"+this.eventNamespace);n.currentTarget=null;this._hide(this.$menu,i,function(){n._trigger("close")})},_setOption:function(t,n){switch(t){case"menu":this.replaceMenu(n);break}e.Widget.prototype._setOption.apply(this,arguments)},_getMenuEntry:function(e){return this.$menu.find("li[data-command="+e+"]")},close:function(){if(this.isOpen()){this._closeMenu()}},enableEntry:function(e,t){this._getMenuEntry(e).toggleClass("ui-state-disabled",t===false)},getMenu:function(){return this.$menu},isOpen:function(){return!!this.$menu&&!!this.currentTarget},open:function(e,t){t=t||{};var n=jQuery.Event("contextmenu",{target:e.get(0),extraData:t});return this.element.trigger(n)},replaceMenu:function(e){this._createUiMenu(e)},setEntry:function(t,n){var i=this._getMenuEntry(t);if(typeof n==="string"){e.moogle.contextmenu.updateTitle(i,n)}else{i.empty();n.cmd=n.cmd||t;e.moogle.contextmenu.createEntryMarkup(n,i)}},showEntry:function(e,t){this._getMenuEntry(e).toggle(t!==false)}});e.extend(e.moogle.contextmenu,{createMenuMarkup:function(t,n){var i,s,o,a;if(n==null){n=e("<ul class='ui-helper-hidden' />").appendTo("body")}for(i=0;i<t.length;i++){s=t[i];a=e("<li/>").appendTo(n);e.moogle.contextmenu.createEntryMarkup(s,a);if(e.isArray(s.children)){o=e("<ul/>").appendTo(a);e.moogle.contextmenu.createMenuMarkup(s.children,o)}}return n},replaceFirstTextNodeChild:function(e,t){e.contents().filter(function(){return this.nodeType===3}).first().replaceWith(t)}});n=e.ui.menu.version.match(/^(\d)\.(\d+)/);i={major:parseInt(n[1],10),minor:parseInt(n[2],10)};if(i.major<2&&i.minor<11){e.extend(e.moogle.contextmenu,{createEntryMarkup:function(t,n){var i=null;if(!/[^\-\u2014\u2013\s]/.test(t.title)){n.text(t.title)}else{n.attr("data-command",t.cmd);i=e("<a/>",{html:""+t.title,href:"#"}).appendTo(n);if(e.isFunction(t.action)){n.data("actionHandler",t.action)}if(t.uiIcon){i.append(e("<span class='ui-icon' />").addClass(t.uiIcon))}if(t.disabled){n.addClass("ui-state-disabled")}if(e.isPlainObject(t.data)){i.data(t.data)}}},isMenu:function(e){return e.has(">a[aria-haspopup='true']").length>0},updateTitle:function(t,n){e.moogle.contextmenu.replaceFirstTextNodeChild(e("a",t),n)}})}else{e.extend(e.moogle.contextmenu,{createEntryMarkup:function(t,n){if(!/[^\-\u2014\u2013\s]/.test(t.title)){n.text(t.title)}else{n.attr("data-command",t.cmd).html(""+t.title);if(e.isFunction(t.action)){n.data("actionHandler",t.action)}if(t.uiIcon){n.append(e("<span class='ui-icon' />").addClass(t.uiIcon))}if(t.disabled){n.addClass("ui-state-disabled")}if(e.isPlainObject(t.data)){n.data(t.data)}}},isMenu:function(e){return e.is("[aria-haspopup='true']")},updateTitle:function(t,n){e.moogle.contextmenu.replaceFirstTextNodeChild(t,n)}})}});
//# sourceMappingURL=jquery.ui-contextmenu.min.map